{"ast":null,"code":"// Generated by CoffeeScript 1.12.7\n(function () {\n  var JSONStorage,\n      KEY_FOR_EMPTY_STRING,\n      LocalStorage,\n      MetaKey,\n      QUOTA_EXCEEDED_ERR,\n      StorageEvent,\n      _emptyDirectory,\n      _escapeKey,\n      _rm,\n      createMap,\n      events,\n      fs,\n      path,\n      writeSync,\n      extend = function extend(child, parent) {\n    for (var key in parent) {\n      if (hasProp.call(parent, key)) child[key] = parent[key];\n    }\n\n    function ctor() {\n      this.constructor = child;\n    }\n\n    ctor.prototype = parent.prototype;\n    child.prototype = new ctor();\n    child.__super__ = parent.prototype;\n    return child;\n  },\n      hasProp = {}.hasOwnProperty;\n\n  path = require('path');\n  fs = require('fs');\n  events = require('events');\n  writeSync = require('write-file-atomic').sync;\n  KEY_FOR_EMPTY_STRING = '---.EMPTY_STRING.---';\n\n  _emptyDirectory = function _emptyDirectory(target) {\n    var i, len, p, ref, results;\n    ref = fs.readdirSync(target);\n    results = [];\n\n    for (i = 0, len = ref.length; i < len; i++) {\n      p = ref[i];\n      results.push(_rm(path.join(target, p)));\n    }\n\n    return results;\n  };\n\n  _rm = function _rm(target) {\n    if (fs.statSync(target).isDirectory()) {\n      _emptyDirectory(target);\n\n      return fs.rmdirSync(target);\n    } else {\n      return fs.unlinkSync(target);\n    }\n  };\n\n  _escapeKey = function _escapeKey(key) {\n    var newKey;\n\n    if (key === '') {\n      newKey = KEY_FOR_EMPTY_STRING;\n    } else {\n      newKey = key.toString();\n    }\n\n    return newKey;\n  };\n\n  QUOTA_EXCEEDED_ERR = function (superClass) {\n    extend(QUOTA_EXCEEDED_ERR, superClass);\n\n    function QUOTA_EXCEEDED_ERR(message) {\n      this.message = message != null ? message : 'Unknown error.';\n\n      QUOTA_EXCEEDED_ERR.__super__.constructor.call(this);\n\n      if (Error.captureStackTrace != null) {\n        Error.captureStackTrace(this, this.constructor);\n      }\n\n      this.name = this.constructor.name;\n    }\n\n    QUOTA_EXCEEDED_ERR.prototype.toString = function () {\n      return this.name + \": \" + this.message;\n    };\n\n    return QUOTA_EXCEEDED_ERR;\n  }(Error);\n\n  StorageEvent = function () {\n    function StorageEvent(key1, oldValue1, newValue1, url, storageArea) {\n      this.key = key1;\n      this.oldValue = oldValue1;\n      this.newValue = newValue1;\n      this.url = url;\n      this.storageArea = storageArea != null ? storageArea : 'localStorage';\n    }\n\n    return StorageEvent;\n  }();\n\n  MetaKey = function () {\n    function MetaKey(key1, index1) {\n      this.key = key1;\n      this.index = index1;\n\n      if (!(this instanceof MetaKey)) {\n        return new MetaKey(this.key, this.index);\n      }\n    }\n\n    return MetaKey;\n  }();\n\n  createMap = function createMap() {\n    var Map;\n\n    Map = function Map() {};\n\n    Map.prototype = Object.create(null);\n    return new Map();\n  };\n\n  LocalStorage = function (superClass) {\n    var instanceMap;\n    extend(LocalStorage, superClass);\n    instanceMap = {};\n\n    function LocalStorage(_location, quota) {\n      var handler;\n      this._location = _location;\n      this.quota = quota != null ? quota : 5 * 1024 * 1024;\n\n      LocalStorage.__super__.constructor.call(this);\n\n      if (!(this instanceof LocalStorage)) {\n        return new LocalStorage(this._location, this.quota);\n      }\n\n      this._location = path.resolve(this._location);\n\n      if (instanceMap[this._location] != null) {\n        return instanceMap[this._location];\n      }\n\n      this.length = 0;\n      this._bytesInUse = 0;\n      this._keys = [];\n      this._metaKeyMap = createMap();\n      this._eventUrl = \"pid:\" + process.pid;\n\n      this._init();\n\n      this._QUOTA_EXCEEDED_ERR = QUOTA_EXCEEDED_ERR;\n\n      if (typeof Proxy !== \"undefined\" && Proxy !== null) {\n        handler = {\n          set: function (_this) {\n            return function (receiver, key, value) {\n              if (_this[key] != null) {\n                return _this[key] = value;\n              } else {\n                return _this.setItem(key, value);\n              }\n            };\n          }(this),\n          get: function (_this) {\n            return function (receiver, key) {\n              if (_this[key] != null) {\n                return _this[key];\n              } else {\n                return _this.getItem(key);\n              }\n            };\n          }(this)\n        };\n        instanceMap[this._location] = new Proxy(this, handler);\n        return instanceMap[this._location];\n      }\n\n      instanceMap[this._location] = this;\n      return instanceMap[this._location];\n    }\n\n    LocalStorage.prototype._init = function () {\n      var _MetaKey, _decodedKey, _keys, e, i, index, k, len, stat;\n\n      try {\n        stat = fs.statSync(this._location);\n\n        if (stat != null && !stat.isDirectory()) {\n          throw new Error(\"A file exists at the location '\" + this._location + \"' when trying to create/open localStorage\");\n        }\n\n        this._bytesInUse = 0;\n        this.length = 0;\n        _keys = fs.readdirSync(this._location);\n\n        for (index = i = 0, len = _keys.length; i < len; index = ++i) {\n          k = _keys[index];\n          _decodedKey = decodeURIComponent(k);\n\n          this._keys.push(_decodedKey);\n\n          _MetaKey = new MetaKey(k, index);\n          this._metaKeyMap[_decodedKey] = _MetaKey;\n          stat = this._getStat(k);\n\n          if ((stat != null ? stat.size : void 0) != null) {\n            _MetaKey.size = stat.size;\n            this._bytesInUse += stat.size;\n          }\n        }\n\n        this.length = _keys.length;\n      } catch (error) {\n        e = error;\n\n        if (e.code !== \"ENOENT\") {\n          throw e;\n        }\n\n        try {\n          fs.mkdirSync(this._location, {\n            recursive: true\n          });\n        } catch (error) {\n          e = error;\n\n          if (e.code !== \"EEXIST\") {\n            throw e;\n          }\n        }\n      }\n    };\n\n    LocalStorage.prototype.setItem = function (key, value) {\n      var encodedKey, evnt, existsBeforeSet, filename, hasListeners, metaKey, oldLength, oldValue, valueString, valueStringLength;\n      hasListeners = events.EventEmitter.listenerCount(this, 'storage');\n      oldValue = null;\n\n      if (hasListeners) {\n        oldValue = this.getItem(key);\n      }\n\n      key = _escapeKey(key);\n      encodedKey = encodeURIComponent(key);\n      filename = path.join(this._location, encodedKey);\n      valueString = value.toString();\n      valueStringLength = valueString.length;\n      metaKey = this._metaKeyMap[key];\n      existsBeforeSet = !!metaKey;\n\n      if (existsBeforeSet) {\n        oldLength = metaKey.size;\n      } else {\n        oldLength = 0;\n      }\n\n      if (this._bytesInUse - oldLength + valueStringLength > this.quota) {\n        throw new QUOTA_EXCEEDED_ERR();\n      }\n\n      writeSync(filename, valueString, 'utf8');\n\n      if (!existsBeforeSet) {\n        metaKey = new MetaKey(encodedKey, this._keys.push(key) - 1);\n        metaKey.size = valueStringLength;\n        this._metaKeyMap[key] = metaKey;\n        this.length += 1;\n        this._bytesInUse += valueStringLength;\n      }\n\n      if (hasListeners) {\n        evnt = new StorageEvent(key, oldValue, value, this._eventUrl);\n        return this.emit('storage', evnt);\n      }\n    };\n\n    LocalStorage.prototype.getItem = function (key) {\n      var filename, metaKey;\n      key = _escapeKey(key);\n      metaKey = this._metaKeyMap[key];\n\n      if (!!metaKey) {\n        filename = path.join(this._location, metaKey.key);\n        return fs.readFileSync(filename, 'utf8');\n      } else {\n        return null;\n      }\n    };\n\n    LocalStorage.prototype._getStat = function (key) {\n      var filename;\n      key = _escapeKey(key);\n      filename = path.join(this._location, encodeURIComponent(key));\n\n      try {\n        return fs.statSync(filename);\n      } catch (error) {\n        return null;\n      }\n    };\n\n    LocalStorage.prototype.removeItem = function (key) {\n      var evnt, filename, hasListeners, k, meta, metaKey, oldValue, ref, v;\n      key = _escapeKey(key);\n      metaKey = this._metaKeyMap[key];\n\n      if (!!metaKey) {\n        hasListeners = events.EventEmitter.listenerCount(this, 'storage');\n        oldValue = null;\n\n        if (hasListeners) {\n          oldValue = this.getItem(key);\n        }\n\n        delete this._metaKeyMap[key];\n        this.length -= 1;\n        this._bytesInUse -= metaKey.size;\n        filename = path.join(this._location, metaKey.key);\n\n        this._keys.splice(metaKey.index, 1);\n\n        ref = this._metaKeyMap;\n\n        for (k in ref) {\n          v = ref[k];\n          meta = this._metaKeyMap[k];\n\n          if (meta.index > metaKey.index) {\n            meta.index -= 1;\n          }\n        }\n\n        _rm(filename);\n\n        if (hasListeners) {\n          evnt = new StorageEvent(key, oldValue, null, this._eventUrl);\n          return this.emit('storage', evnt);\n        }\n      }\n    };\n\n    LocalStorage.prototype.key = function (n) {\n      var rawKey;\n      rawKey = this._keys[n];\n\n      if (rawKey === KEY_FOR_EMPTY_STRING) {\n        return '';\n      } else {\n        return rawKey;\n      }\n    };\n\n    LocalStorage.prototype.clear = function () {\n      var evnt;\n\n      _emptyDirectory(this._location);\n\n      this._metaKeyMap = createMap();\n      this._keys = [];\n      this.length = 0;\n      this._bytesInUse = 0;\n\n      if (events.EventEmitter.listenerCount(this, 'storage')) {\n        evnt = new StorageEvent(null, null, null, this._eventUrl);\n        return this.emit('storage', evnt);\n      }\n    };\n\n    LocalStorage.prototype._getBytesInUse = function () {\n      return this._bytesInUse;\n    };\n\n    LocalStorage.prototype._deleteLocation = function () {\n      delete instanceMap[this._location];\n\n      _rm(this._location);\n\n      this._metaKeyMap = {};\n      this._keys = [];\n      this.length = 0;\n      return this._bytesInUse = 0;\n    };\n\n    return LocalStorage;\n  }(events.EventEmitter);\n\n  JSONStorage = function (superClass) {\n    extend(JSONStorage, superClass);\n\n    function JSONStorage() {\n      return JSONStorage.__super__.constructor.apply(this, arguments);\n    }\n\n    JSONStorage.prototype.setItem = function (key, value) {\n      var newValue;\n      newValue = JSON.stringify(value);\n      return JSONStorage.__super__.setItem.call(this, key, newValue);\n    };\n\n    JSONStorage.prototype.getItem = function (key) {\n      return JSON.parse(JSONStorage.__super__.getItem.call(this, key));\n    };\n\n    return JSONStorage;\n  }(LocalStorage);\n\n  exports.LocalStorage = LocalStorage;\n  exports.JSONStorage = JSONStorage;\n  exports.QUOTA_EXCEEDED_ERR = QUOTA_EXCEEDED_ERR;\n}).call(this);","map":{"version":3,"sources":["/home/ts/Documents/aarone/new(29Dec)/socket-link/my-app/node_modules/node-localstorage/LocalStorage.js"],"names":["JSONStorage","KEY_FOR_EMPTY_STRING","LocalStorage","MetaKey","QUOTA_EXCEEDED_ERR","StorageEvent","_emptyDirectory","_escapeKey","_rm","createMap","events","fs","path","writeSync","extend","child","parent","key","hasProp","call","ctor","constructor","prototype","__super__","hasOwnProperty","require","sync","target","i","len","p","ref","results","readdirSync","length","push","join","statSync","isDirectory","rmdirSync","unlinkSync","newKey","toString","superClass","message","Error","captureStackTrace","name","key1","oldValue1","newValue1","url","storageArea","oldValue","newValue","index1","index","Map","Object","create","instanceMap","_location","quota","handler","resolve","_bytesInUse","_keys","_metaKeyMap","_eventUrl","process","pid","_init","_QUOTA_EXCEEDED_ERR","Proxy","set","_this","receiver","value","setItem","get","getItem","_MetaKey","_decodedKey","e","k","stat","decodeURIComponent","_getStat","size","error","code","mkdirSync","recursive","encodedKey","evnt","existsBeforeSet","filename","hasListeners","metaKey","oldLength","valueString","valueStringLength","EventEmitter","listenerCount","encodeURIComponent","emit","readFileSync","removeItem","meta","v","splice","n","rawKey","clear","_getBytesInUse","_deleteLocation","apply","arguments","JSON","stringify","parse","exports"],"mappings":"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","sourcesContent":["// Generated by CoffeeScript 1.12.7\n(function() {\n  var JSONStorage, KEY_FOR_EMPTY_STRING, LocalStorage, MetaKey, QUOTA_EXCEEDED_ERR, StorageEvent, _emptyDirectory, _escapeKey, _rm, createMap, events, fs, path, writeSync,\n    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    hasProp = {}.hasOwnProperty;\n\n  path = require('path');\n\n  fs = require('fs');\n\n  events = require('events');\n\n  writeSync = require('write-file-atomic').sync;\n\n  KEY_FOR_EMPTY_STRING = '---.EMPTY_STRING.---';\n\n  _emptyDirectory = function(target) {\n    var i, len, p, ref, results;\n    ref = fs.readdirSync(target);\n    results = [];\n    for (i = 0, len = ref.length; i < len; i++) {\n      p = ref[i];\n      results.push(_rm(path.join(target, p)));\n    }\n    return results;\n  };\n\n  _rm = function(target) {\n    if (fs.statSync(target).isDirectory()) {\n      _emptyDirectory(target);\n      return fs.rmdirSync(target);\n    } else {\n      return fs.unlinkSync(target);\n    }\n  };\n\n  _escapeKey = function(key) {\n    var newKey;\n    if (key === '') {\n      newKey = KEY_FOR_EMPTY_STRING;\n    } else {\n      newKey = key.toString();\n    }\n    return newKey;\n  };\n\n  QUOTA_EXCEEDED_ERR = (function(superClass) {\n    extend(QUOTA_EXCEEDED_ERR, superClass);\n\n    function QUOTA_EXCEEDED_ERR(message) {\n      this.message = message != null ? message : 'Unknown error.';\n      QUOTA_EXCEEDED_ERR.__super__.constructor.call(this);\n      if (Error.captureStackTrace != null) {\n        Error.captureStackTrace(this, this.constructor);\n      }\n      this.name = this.constructor.name;\n    }\n\n    QUOTA_EXCEEDED_ERR.prototype.toString = function() {\n      return this.name + \": \" + this.message;\n    };\n\n    return QUOTA_EXCEEDED_ERR;\n\n  })(Error);\n\n  StorageEvent = (function() {\n    function StorageEvent(key1, oldValue1, newValue1, url, storageArea) {\n      this.key = key1;\n      this.oldValue = oldValue1;\n      this.newValue = newValue1;\n      this.url = url;\n      this.storageArea = storageArea != null ? storageArea : 'localStorage';\n    }\n\n    return StorageEvent;\n\n  })();\n\n  MetaKey = (function() {\n    function MetaKey(key1, index1) {\n      this.key = key1;\n      this.index = index1;\n      if (!(this instanceof MetaKey)) {\n        return new MetaKey(this.key, this.index);\n      }\n    }\n\n    return MetaKey;\n\n  })();\n\n  createMap = function() {\n    var Map;\n    Map = function() {};\n    Map.prototype = Object.create(null);\n    return new Map();\n  };\n\n  LocalStorage = (function(superClass) {\n    var instanceMap;\n\n    extend(LocalStorage, superClass);\n\n    instanceMap = {};\n\n    function LocalStorage(_location, quota) {\n      var handler;\n      this._location = _location;\n      this.quota = quota != null ? quota : 5 * 1024 * 1024;\n      LocalStorage.__super__.constructor.call(this);\n      if (!(this instanceof LocalStorage)) {\n        return new LocalStorage(this._location, this.quota);\n      }\n      this._location = path.resolve(this._location);\n      if (instanceMap[this._location] != null) {\n        return instanceMap[this._location];\n      }\n      this.length = 0;\n      this._bytesInUse = 0;\n      this._keys = [];\n      this._metaKeyMap = createMap();\n      this._eventUrl = \"pid:\" + process.pid;\n      this._init();\n      this._QUOTA_EXCEEDED_ERR = QUOTA_EXCEEDED_ERR;\n      if (typeof Proxy !== \"undefined\" && Proxy !== null) {\n        handler = {\n          set: (function(_this) {\n            return function(receiver, key, value) {\n              if (_this[key] != null) {\n                return _this[key] = value;\n              } else {\n                return _this.setItem(key, value);\n              }\n            };\n          })(this),\n          get: (function(_this) {\n            return function(receiver, key) {\n              if (_this[key] != null) {\n                return _this[key];\n              } else {\n                return _this.getItem(key);\n              }\n            };\n          })(this)\n        };\n        instanceMap[this._location] = new Proxy(this, handler);\n        return instanceMap[this._location];\n      }\n      instanceMap[this._location] = this;\n      return instanceMap[this._location];\n    }\n\n    LocalStorage.prototype._init = function() {\n      var _MetaKey, _decodedKey, _keys, e, i, index, k, len, stat;\n      try {\n        stat = fs.statSync(this._location);\n        if ((stat != null) && !stat.isDirectory()) {\n          throw new Error(\"A file exists at the location '\" + this._location + \"' when trying to create/open localStorage\");\n        }\n        this._bytesInUse = 0;\n        this.length = 0;\n        _keys = fs.readdirSync(this._location);\n        for (index = i = 0, len = _keys.length; i < len; index = ++i) {\n          k = _keys[index];\n          _decodedKey = decodeURIComponent(k);\n          this._keys.push(_decodedKey);\n          _MetaKey = new MetaKey(k, index);\n          this._metaKeyMap[_decodedKey] = _MetaKey;\n          stat = this._getStat(k);\n          if ((stat != null ? stat.size : void 0) != null) {\n            _MetaKey.size = stat.size;\n            this._bytesInUse += stat.size;\n          }\n        }\n        this.length = _keys.length;\n      } catch (error) {\n        e = error;\n        if (e.code !== \"ENOENT\") {\n          throw e;\n        }\n        try {\n          fs.mkdirSync(this._location, {\n            recursive: true\n          });\n        } catch (error) {\n          e = error;\n          if (e.code !== \"EEXIST\") {\n            throw e;\n          }\n        }\n      }\n    };\n\n    LocalStorage.prototype.setItem = function(key, value) {\n      var encodedKey, evnt, existsBeforeSet, filename, hasListeners, metaKey, oldLength, oldValue, valueString, valueStringLength;\n      hasListeners = events.EventEmitter.listenerCount(this, 'storage');\n      oldValue = null;\n      if (hasListeners) {\n        oldValue = this.getItem(key);\n      }\n      key = _escapeKey(key);\n      encodedKey = encodeURIComponent(key);\n      filename = path.join(this._location, encodedKey);\n      valueString = value.toString();\n      valueStringLength = valueString.length;\n      metaKey = this._metaKeyMap[key];\n      existsBeforeSet = !!metaKey;\n      if (existsBeforeSet) {\n        oldLength = metaKey.size;\n      } else {\n        oldLength = 0;\n      }\n      if (this._bytesInUse - oldLength + valueStringLength > this.quota) {\n        throw new QUOTA_EXCEEDED_ERR();\n      }\n      writeSync(filename, valueString, 'utf8');\n      if (!existsBeforeSet) {\n        metaKey = new MetaKey(encodedKey, (this._keys.push(key)) - 1);\n        metaKey.size = valueStringLength;\n        this._metaKeyMap[key] = metaKey;\n        this.length += 1;\n        this._bytesInUse += valueStringLength;\n      }\n      if (hasListeners) {\n        evnt = new StorageEvent(key, oldValue, value, this._eventUrl);\n        return this.emit('storage', evnt);\n      }\n    };\n\n    LocalStorage.prototype.getItem = function(key) {\n      var filename, metaKey;\n      key = _escapeKey(key);\n      metaKey = this._metaKeyMap[key];\n      if (!!metaKey) {\n        filename = path.join(this._location, metaKey.key);\n        return fs.readFileSync(filename, 'utf8');\n      } else {\n        return null;\n      }\n    };\n\n    LocalStorage.prototype._getStat = function(key) {\n      var filename;\n      key = _escapeKey(key);\n      filename = path.join(this._location, encodeURIComponent(key));\n      try {\n        return fs.statSync(filename);\n      } catch (error) {\n        return null;\n      }\n    };\n\n    LocalStorage.prototype.removeItem = function(key) {\n      var evnt, filename, hasListeners, k, meta, metaKey, oldValue, ref, v;\n      key = _escapeKey(key);\n      metaKey = this._metaKeyMap[key];\n      if (!!metaKey) {\n        hasListeners = events.EventEmitter.listenerCount(this, 'storage');\n        oldValue = null;\n        if (hasListeners) {\n          oldValue = this.getItem(key);\n        }\n        delete this._metaKeyMap[key];\n        this.length -= 1;\n        this._bytesInUse -= metaKey.size;\n        filename = path.join(this._location, metaKey.key);\n        this._keys.splice(metaKey.index, 1);\n        ref = this._metaKeyMap;\n        for (k in ref) {\n          v = ref[k];\n          meta = this._metaKeyMap[k];\n          if (meta.index > metaKey.index) {\n            meta.index -= 1;\n          }\n        }\n        _rm(filename);\n        if (hasListeners) {\n          evnt = new StorageEvent(key, oldValue, null, this._eventUrl);\n          return this.emit('storage', evnt);\n        }\n      }\n    };\n\n    LocalStorage.prototype.key = function(n) {\n      var rawKey;\n      rawKey = this._keys[n];\n      if (rawKey === KEY_FOR_EMPTY_STRING) {\n        return '';\n      } else {\n        return rawKey;\n      }\n    };\n\n    LocalStorage.prototype.clear = function() {\n      var evnt;\n      _emptyDirectory(this._location);\n      this._metaKeyMap = createMap();\n      this._keys = [];\n      this.length = 0;\n      this._bytesInUse = 0;\n      if (events.EventEmitter.listenerCount(this, 'storage')) {\n        evnt = new StorageEvent(null, null, null, this._eventUrl);\n        return this.emit('storage', evnt);\n      }\n    };\n\n    LocalStorage.prototype._getBytesInUse = function() {\n      return this._bytesInUse;\n    };\n\n    LocalStorage.prototype._deleteLocation = function() {\n      delete instanceMap[this._location];\n      _rm(this._location);\n      this._metaKeyMap = {};\n      this._keys = [];\n      this.length = 0;\n      return this._bytesInUse = 0;\n    };\n\n    return LocalStorage;\n\n  })(events.EventEmitter);\n\n  JSONStorage = (function(superClass) {\n    extend(JSONStorage, superClass);\n\n    function JSONStorage() {\n      return JSONStorage.__super__.constructor.apply(this, arguments);\n    }\n\n    JSONStorage.prototype.setItem = function(key, value) {\n      var newValue;\n      newValue = JSON.stringify(value);\n      return JSONStorage.__super__.setItem.call(this, key, newValue);\n    };\n\n    JSONStorage.prototype.getItem = function(key) {\n      return JSON.parse(JSONStorage.__super__.getItem.call(this, key));\n    };\n\n    return JSONStorage;\n\n  })(LocalStorage);\n\n  exports.LocalStorage = LocalStorage;\n\n  exports.JSONStorage = JSONStorage;\n\n  exports.QUOTA_EXCEEDED_ERR = QUOTA_EXCEEDED_ERR;\n\n}).call(this);\n"]},"metadata":{},"sourceType":"script"}